<!DOCTYPE html>
<html>
  <head>
    <title>系统用户管理</title>
    <base href="#(basePath)"/>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    	<!-- 引入css -->
    	#@cssModel?()
  </head>
  
  <body class="easyui-layout">
  
  		<div data-options="region:'north',border:false">
	    	<div style="float: left;padding-left: 4px;">
	    		<form   onsubmit="return false;" id="queryForm" method="post">
			    	<input type="hidden" value="sys"  name="type" id="type" >
			    	<div class="layui-input-inline"><input type="text"  name="name" id="name" style="height: 30px;width: 100px;"  placeholder="请输入姓名" autocomplete="off" class="layui-input"></div>
			    	<div class="layui-input-inline"><input type="text"  name="address" id="address" style="height: 30px;width: 100px;"  placeholder="输入家庭地址" autocomplete="off" class="layui-input"></div>
			    	<div class="layui-input-inline"><input type="text"  name="insertdate" id="insertdate" style="height: 30px;width: 100px;"  placeholder="输入添加时间" autocomplete="off" class="layui-input"></div>
			    	<div class="layui-input-inline"><input type="text"  name="begindate" id="begindate" style="height: 30px;width: 100px;"  placeholder="出生日期开始" autocomplete="off" class="layui-input"></div>
			    	-
			    	<div class="layui-input-inline"><input type="text"  name="enddate" id="enddate" style="height: 30px;width: 100px;"  placeholder="出生日期结束" autocomplete="off" class="layui-input"></div>
				    <div class="layui-input-inline" title="查询"><button  id="btnQuery"  class="layui-btn   layui-btn-warm layui-btn-small"   style="margin-left: 1px;"><i class="layui-icon">&#xe615;</i></button></div>
				    <div class="layui-input-inline" title="清空"><button  id="cleanQuery"  class="layui-btn    layui-btn-small"   style="margin-left: 1px;"><i class="layui-icon">&#xe639;</i></button></div>
	    		</form>
	    	</div>
	    	<div style="text-align: right;float: right"  class="layui-input-inline">
	    		
	    		<div class="layui-btn-group">
				  <button id="resetPwd" class="layui-btn  layui-btn-warm  layui-btn-small"><i class="layui-icon">重置密码</i></button>
				  <button id="add" class="layui-btn  layui-btn-small"><i class="layui-icon">&#xe654;</i></button>
				  <button id="update" class="layui-btn  layui-btn-small"><i class="layui-icon">&#xe642;</i></button>
				  <button id="delete" class="layui-btn  layui-btn-small"><i class="layui-icon">&#xe640;</i></button>
				</div>
	    	</div>
	    </div>   
	    
	    <div data-options="region:'center',border:false" style="margin-top: 2px;">
	     	 <table id="datagridModel" ></table> 
	    </div> 
  		
  		
  		
  		
  		
  		
    	<!-- 引入js 这个要在自己的上面-->
    	#@jsModel?()
    	
    	<script type="text/javascript">
			layui.config({base: "JFinalNew/js/"}).use(["layer","jquery","common"], function() {
				var $ = layui.jquery;
				var layer = layui.layer;
				var common = layui.common;
				
				var indexModel;/**记录点击行的编号*/
				var datagrid;				
				$(function(){
					datagrid=$("#datagridModel").datagrid({    
					    url:"sysuser/queryList.html",    
					    columns:[[    
					        {field:"realname",title:"真实姓名",width:120,align:"center",sortable:true},    
					        {field:"useRoleName",title:"角色",width:200,align:"center",
					        	formatter: function(value,row,index){
									if (value){return '<a title="'+value+'">'+value+'</a>';
									} else {return "";}
								}
					        },    
					        {field:"age",title:"年龄",width:50,align:"center",sortable:true},    
					        {field:"sexModel",title:"性别",width:50,align:"center"},    
					        {field:"birthday",title:"出生日期",width:100,align:"center",sortable:true},    
					        {field:"address",title:"家庭地址",width:230,align:"center",sortable:true},    
					        {field:"hobby",title:"爱好",width:230,align:"center",sortable:true},    
					        {field:"email",title:"邮箱",width:120,align:"center",sortable:true},    
					        {field:"telephone",title:"联系方式",width:100,align:"center",sortable:true},   
					        {field:"insertdate",title:"添加时间",width:150,align:"center",sortable:true},   
					    ]],
					    frozenColumns:[[
					        {field:"id",title:"用户编号",width:100,align:"center",checkbox:true},  
					        {field:"name",title:"登录名",width:100,align:"center",sortable:true}   
					    ]],
					    autoRowHeight:false,
					    striped:true,
					    nowrap:true,
					    idField:"id",
					    multiSort:true,/**sort=createDate,stationName  order=asc,asc*/
					    loadMsg:"拼命加载中...",
					    pagination:true,
					    singleSelect:false,
					    checkOnSelect:true,
					    selectOnCheck:true,
					    pagePosition:"bottom", 
					    pageNumber:1,
					    pageSize:10,
					    pageList:[10,20,50,100,500,1000],  
					    queryParams:{
					    	type:$("#type").val()
					    },
					    fit:true,
					//    fitColumns:true,
					    onClickRow:function(index,row){
					    	datagrid.datagrid("clearChecked");
					    	datagrid.datagrid("clearSelections");
					    	if(indexModel == row.id){
					    		indexModel="";
					    	}else{
					    		indexModel=row.id;
					    		datagrid.datagrid("selectRow",index);
					    	}
					    }
					}); 
				});
				
				/**提交查询的参数*/
				$("#btnQuery").click(function(){
					load();
				});
				/**清空*/
				$("#cleanQuery").click(function(){
					$("#enddate").val(""),
					$("#name").val(""),
					$("#address").val(""),
					$("#insertdate").val(""),
					$("#begindate").val(""),
					load();
				});
				
				/**时间控件*/
				$("#insertdate").click(function(){
					common.getDataTimeFun(this);
				});
				$("#begindate").click(function(){
					common.getDataTimeFun(this);
				});
				$("#enddate").click(function(){
					common.getDataTimeFun(this);
				});
				/**添加*/
				$("#add").click(function(){
					common.openEditDialog(load,"添加用户","sysuser/editPage.html","1000px","520px",false,"sysuser/edit.html");
				});
				
				/**修改*/
				$("#update").click(function(){
					var rows=datagrid.datagrid("getChecked");
					if(rows.length !=1){
						common.getMsgBlackDialog("只能选择一条记录修改",2000);
						return ;
					}
					common.openEditDialog(load,"修改用户","sysuser/editPage.html?id="+rows[0].id,"1000px","520px",false,"sysuser/edit.html");
				});
				/**密码重置*/
				$("#resetPwd").click(function(){
					var rows=datagrid.datagrid("getChecked");
					if(rows.length == 0){
						common.getMsgBlackDialog("请选中要重置密码的记录",2000);
						return ;
					}
					var ids=[];
					for(var i=0;i<rows.length;i++){
						ids.push(rows[i].id);
					}
					common.getConfirmDelDialog("友情提示","重置密码确认？",3,"sysuser/resetPwd.html",{ids:ids.join(",")},load);
				});
				/**删除*/
				$("#delete").click(function(){
					var rows=datagrid.datagrid("getChecked");
					if(rows.length == 0){
						common.getMsgBlackDialog("请选中要删除的记录",2000);
						return ;
					}
					var ids=[];
					for(var i=0;i<rows.length;i++){
						ids.push(rows[i].id);
					}
					common.getConfirmDelDialog("友情提示","删除再次确认？",3,"sysuser/delete.html",{ids:ids.join(",")},load);
				});
				/**加载
				*/
				function load(){
					var begindate=$("#begindate").val();
					var enddate=$("#enddate").val();
					if((!begindate && !enddate) || (begindate && enddate)){
						datagrid.datagrid("load",{
							name:$("#name").val(),
							address:$("#address").val(),
							insertdate:$("#insertdate").val(),
							begindate:$("#begindate").val(),
							type:$("#type").val(),
							enddate:$("#enddate").val()
						});
						datagrid.datagrid("clearChecked");
						datagrid.datagrid("clearSelections");
					}else{
						common.getMsgBlackDialog("开始日期、结束日期不完整",2000);
					}
				}
			});
  		</script>
  </body>
</html>
