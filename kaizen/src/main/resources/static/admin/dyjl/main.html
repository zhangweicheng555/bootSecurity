<!DOCTYPE html>
<html>
  <head>
    <title>单验记录表</title>
    <base href="#(basePath)"/>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    	<!-- 引入css -->
    	#@cssModel?()
  </head>
  
  <body class="easyui-layout">
  
  		<div data-options="region:'north',border:false">
	    	<div style="float: left;padding-left: 4px;">
	    		<form onsubmit="return false;" id="queryForm" method="post">
			    	<div class="layui-input-inline"><input type="text"  name="stationName" id="stationName" style="height: 30px;"  placeholder="请输入站名" autocomplete="off" class="layui-input"></div>
			    	<div class="layui-input-inline"><input type="text"  name="stationType" id="stationType" style="height: 30px;"  placeholder="请输入基站类型" autocomplete="off" class="layui-input"></div>
			    	<div class="layui-input-inline"><input type="text"  name="person1" id="person1" style="height: 30px;"  placeholder="输入测试人员1" autocomplete="off" class="layui-input"></div>
			    	<div class="layui-input-inline"><input type="text"  name="createDate" id="createDate" style="height: 30px;"  placeholder="输入添加时间" autocomplete="off" class="layui-input"></div>
				    <div class="layui-input-inline"><button  id="btnQuery"  class="layui-btn   layui-btn-warm layui-btn-small"   style="margin-left: 1px;"><i class="layui-icon">&#x1002;</i>查询</button></div>
				    <div class="layui-input-inline"><button  id="cleanQuery"  class="layui-btn    layui-btn-small"   style="margin-left: 1px;"><i class="layui-icon">&#xe639;</i>清空</button></div>
	    		</form>
	    	</div>
	    	<div style="text-align: right;float: right"  class="layui-input-inline">
	    		
	    		<div class="layui-btn-group">
	    		  <button class="layui-btn layui-btn-small" id="export">导出</button>
				  <button id="add" class="layui-btn  layui-btn-small"><i class="layui-icon">&#xe654;</i></button>
				  <button id="update" class="layui-btn  layui-btn-small"><i class="layui-icon">&#xe642;</i></button>
				  <button id="delete" class="layui-btn  layui-btn-small"><i class="layui-icon">&#xe640;</i></button>
				</div>
	    	</div>
	    </div>   
	    
	    <div data-options="region:'center',border:false" style="margin-top: 2px;">
	     	 <table id="datagridModel" ></table> 
	    </div> 
  		
  		
  		
  		<!-- 导出专用 -->
  		<form  id="exportForm"  action="dyjl/export.html" method="post">
	    	<input type="text"  name="stationName" id="stationNameM" >
	    	<input type="text"  name="stationType" id="stationTypeM" >
	    	<input type="text"  name="person1" id="person1M" >
	    	<input type="text"  name="createDate" id="createDateM" >
	    </form>
  		
  		
    	<!-- 引入js 这个要在自己的上面-->
    	#@jsModel?()
    	
    	<script type="text/javascript">
			layui.config({base: "JFinalNew/js/"}).use(["layer","jquery","common"], function() {
				var $ = layui.jquery;
				var layer = layui.layer;
				var common = layui.common;
				
				var datagrid;				
				$(function(){
					datagrid=$("#datagridModel").datagrid({    
					    url:"dyjl/queryList.html",    
					    columns:[[    
					        {field:"stationType",title:"基站类型",width:100,align:"center"},    
					        {field:"virtualNumber",title:"簇号",width:100,align:"center",sortable:true},    
					        {field:"person1",title:"测试人员1",width:100,align:"center"},    
					        {field:"reason",title:"单验未通过原因",width:230,align:"center"},    
					        {field:"unCheckPass",title:"客户审核未通过原因",width:230,align:"center"},    
					        {field:"createDate",title:"添加时间",width:100,align:"center",sortable:true}    
					    ]],
					    frozenColumns:[[
					        {field:"stationId",title:"站号",width:100,align:"center",checkbox:true},  
					        {field:"stationName",title:"站名",width:150,align:"center",sortable:true}   
					    ]],
					    autoRowHeight:false,
					    striped:true,
					    nowrap:true,
					    idField:"id",
					    multiSort:true,/**sort=createDate,stationName  order=asc,asc*/
					    loadMsg:"拼命加载中...",
					    pagination:true,
					    singleSelect:false,
					    checkOnSelect:true,
					    selectOnCheck:true,
					    pagePosition:"bottom", 
					    pageNumber:1,
					    pageSize:10,
					    pageList:[10,20,50,100,500,1000],  
					    queryParams:{},
					    fit:true,
					    fitColumns:true,
					    onClickRow:function(index,row){
					    	datagrid.datagrid("clearChecked");
					    	datagrid.datagrid("clearSelections");
					    	datagrid.datagrid("selectRow",index);
					    }
					}); 
				});
				/**导出*/
				$("#export").click(function(){//
					$("#stationNameM").val($("#stationName").val());
					$("#stationTypeM").val($("#stationType").val());
					$("#person1M").val($("#person1").val());
					$("#createDateM").val($("#createDate").val());
					$("#exportForm").submit();
					common.showLoadingTimeDialog(4000);
				});
				/**提交查询的参数*/
				$("#btnQuery").click(function(){
					datagrid.datagrid("clearChecked");
					datagrid.datagrid("clearSelections");
					load();
				});
				/**清空*/
				$("#cleanQuery").click(function(){
					$("#stationName").val(""),
					$("#stationType").val(""),
					$("#person1").val(""),
					$("#createDate").val("")
					load();
				});
				
				/**时间控件*/
				$("#createDate").click(function(){
					common.getDataTimeFun(this);
				});
				/**添加*/
				$("#add").click(function(){
					common.openEditDialog(load,"添加单验记录","dyjl/editPage.html","750px","480px",false,"dyjl/edit.html");
				});
				/**修改*/
				$("#update").click(function(){
					var rows=datagrid.datagrid("getChecked");
					if(rows.length !=1){
						common.getMsgDialog("只能选择一条记录修改",5,2000);
						return ;
					}
					common.openEditDialog(load,"修改单验记录","dyjl/editPage.html?id="+rows[0].id,"750px","480px",false,"dyjl/edit.html");
				});
				/**删除*/
				$("#delete").click(function(){
					var rows=datagrid.datagrid("getChecked");
					if(rows.length == 0){
						common.getMsgBlackDialog("请选中要删除的记录",2000);
						return ;
					}
					var ids=[];
					for(var i=0;i<rows.length;i++){
						ids.push(rows[i].id);
					}
					common.getConfirmDelDialog("友情提示","删除再次确认？",3,"dyjl/delete.html",{ids:ids.join(",")},load);
				});
				/**加载*/
				function load(){
					datagrid.datagrid("load",{
					stationName:$("#stationName").val(),
					stationType:$("#stationType").val(),
					person1:$("#person1").val(),
					createDate:$("#createDate").val()
					});
					datagrid.datagrid("clearChecked");
					datagrid.datagrid("clearSelections");
				}
			});
  		</script>
  </body>
</html>
