<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>用户管理列表</title>
<link rel="stylesheet" type="text/css" media="screen" href="../../css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" media="screen" href="../../css/dataTables.bootstrap.min.css">
<link rel="stylesheet" type="text/css" media="screen" href="../../layui/css/layui.css">
</head>
<body>
    <div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <!-- 搜索功能区域 -->
                <header style="height: 100%">
                    <div align="left">
	                    <table style="width: 100%">
	                   		<tr>
	                   			<td>
									<form class="form-inline" onsubmit="return false">
										<div class="form-group">
											用户名：
											<input id="username" type="text" class="form-control" placeholder="用户名">
											昵称：
											<input id="nickname" type="text" class="form-control" placeholder="昵称">
											状态：
											<select class="form-control input-sm" id="status">
											</select>
											<button id="searchBt" class="layui-btn layui-btn-sm" permission="sys:user:query"><i class="layui-icon">&#xe615;</i>搜索</button>
											<button id="searchBt1" class="layui-btn layui-btn-sm" permission="sys:user:query"><i class="layui-icon">&#xe615;</i>搜索1</button>
										</div>
									</form>
								</td>
								<td align="right">
	                   				<button class="layui-btn layui-btn-sm" onclick="location.href='addUser.html'" permission="sys:user:add">
                                      <i class="layui-icon">&#xe608;</i> 添加
                                    </button>
	                   			</td>
	                   		</tr> 
	                    </table>
					</div>
                </header>
                
                <div>
                    <div class="widget-body no-padding">
                       	<!-- 列表展示区域 -->
                       	<table class="layui-hide" id="test" lay-filter="test"></table>
                    </div>
                </div>
        </div>
    </div>
</body>
</html>

<script type="text/javascript" src="../../js/libs/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="../../js/jq.js"></script>
<script type="text/javascript" src="../../js/my/permission.js"></script>
<script type="text/javascript" src="../../layui/layui.js"></script>

<script type="text/javascript">
layui.use([ 'layer' ,'table'], function() {
	  var layer = layui.layer;
	  
	  var table = layui.table;
	  var tableIns=table.render({//tableIns  方便对后续的table进行操作
	    elem: '#test'    //指定原始 table 容器的选择器或 DOM，方法渲染方式必填
	    ,id:'test'
	    ,url:'/test.json'  //异步数据接口相关参数
	  //  ,method:'post'     //接口http请求类型，默认：get
	   // ,where:{'name':'张三','id':1},
	    //,contentType: 'application/json',//送到服务端的内容编码类型。如果你要发送 json 内容
	   /*  ,request: {用于对分页请求的参数：page、limit重新设定名称，如：
	        pageName: 'curr' //页码的参数名称，默认：page
	            ,limitName: 'nums' //每页数据量的参数名，默认：limit
	          } */
         /*  ,response: {   重置json字段的类型
        	    statusName: 'status' //规定数据状态的字段名称，默认：code
        	    ,statusCode: 200 //规定成功的状态码，默认：0
        	    ,msgName: 'hint' //规定状态信息的字段名称，默认：msg
        	    ,countName: 'total' //规定数据总数的字段名称，默认：count
        	    ,dataName: 'rows' //规定数据列表的字段名称，默认：data
        	  } , */
	    ,cols: [[        //设置表头。值是一个二维数组。方法渲染方式必填
	      {field:'id', width:30, title: 'ID', sort: true,type:'checkbox',fixed:'left'}
	      ,{field:'username', width:'20%', title: '用户名',fixed:'left',align:'center'}
	      ,{field:'sex', width:80, title: '性别', sort: true}
	      ,{field:'city', width:80, title: '城市'}
	      ,{field:'sign', title: '签名', minWidth: 150}
	      ,{field:'experience', width:80, title: '积分', sort: true}
	      ,{field:'score', width:80, title: '评分', sort: true}
	      ,{field:'classify', width:80, title: '职业'}
	      ,{field:'wealth', width:135, title: '财富', sort: true}
	    ]]
	    ,page: true
	    ,limit:10
	    ,limits:[10,20,30,40,50,60,70,80,900]  //这个地方注意，是不加引号的
	    ,done: function(res, curr, count){//  数据渲染完的回调。
	        //如果是异步请求数据方式，res即为你接口返回的信息。
	        //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
	       // console.log(res);
	        
	        //得到当前页码
	       // console.log(curr); 
	        
	        //得到数据总量
	        //console.log(count);
	      }
        ,loading:true//是否显示加载条（默认：true）
        ,text: {//内置一些默认的文本信息
            none: '暂无相关数据' //默认：无数据。注：该属性为 layui 2.2.5 开始新增
        }
       /*  ,initSort: {//初始排序状态。用于在数据表格渲染完毕时，
            field: 'id' //排序字段，对应 cols 设定的各字段名
            ,type: 'desc' //排序方式  asc: 升序、desc: 降序、null: 默认排序
        } */
//        height :  默认情况。高度随数据列表而适应，表格容器不会出现纵向滚动条
        ,height:'full-40'
        //width:  默认是铺满
         //,skin: 'row' //行边框风格
		 ,even: false //开启隔行背景
		 ,size: 'sm' //小尺寸的表格sm  lg
	  });
	  
	  $("#searchBt1").click(function(){
		  var checkStatus = table.checkStatus('test'); //test即为基础参数id对应的值
		  console.log(checkStatus.data) //获取选中行的数据
		  console.log(checkStatus.data.length) //获取选中行数量，可作为是否有选中行的条件
		  console.log(checkStatus.isAll ) //表格是否全选
		 
		  tableIns.reload({//表格的重载
			 page: {
				    curr: 5 //重新从第 1 页开始
				  }
			});
		  
		  table.exportFile('test', checkStatus.data,'xls'); //data 为该实例中的任意数量的数据
	  });
	  
	  //监听行单击事件（单击事件为：rowDouble）
	  table.on('row(test)', function(obj){
	    var data = obj.data;
	   //JSON.stringify(data)  数据的josn串
	    //标注选中样式
	    obj.tr.addClass('layui-table-click').siblings().removeClass('layui-table-click');
	  });

	  
	  table.on('rowDouble(test)', function(obj){
		  console.log(obj.tr) //得到当前行元素对象
		  console.log(obj.data) //得到当前行数据
		  //obj.del(); //删除当前行
		  //obj.update(fields) //修改当前行数据
	});
});
var pers = checkPermission();

</script>